{"ast":null,"code":"var _jsxFileName = \"/Users/apple/Desktop/submit 3/compliance-client/src/pages/Login.js\";\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { Redirect, useLocation } from \"react-router-dom\";\nimport FormErrors from \"../components/FormErrors\";\nimport FlashMessage from \"../components/FlashMessage\";\nimport { Form, Button } from \"react-bootstrap\";\n\nfunction Login(props) {\n  const [formValues, setFormValues] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  const [redirectTo, setRedirectTo] = useState(\"\");\n  const [formErrors, setFormErrors] = useState([]);\n  const location = useLocation();\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!validateForm()) return;\n\n    try {\n      const response = await axios.post(\"/user/login\", formValues);\n\n      if (response.status === 200) {\n        console.log(\"logged in\");\n        props.setUser({\n          isLoggedIn: true,\n          email: response.data.email\n        });\n        setRedirectTo(\"/dashboard\");\n      } else {\n        console.log(\"not logged in\");\n        console.log(response.status);\n      }\n    } catch (err) {\n      console.log(\"login error\");\n      console.log(err.response);\n\n      if (err.response.status === 401) {\n        // Incorrect email password pair\n        setFormErrors([\"Incorrect email or password\"]);\n      } else {\n        setRedirectTo(\"/serverError\");\n      }\n    }\n  };\n\n  const validateForm = () => {\n    const errors = [];\n\n    if (formValues.email.length < 1) {\n      errors.push(\"Please enter your email\");\n    }\n\n    if (formValues.password.length < 1) {\n      errors.push(\"Please enter your password\");\n    }\n\n    if (errors.length > 0) {\n      setFormErrors(errors);\n      return false;\n    }\n\n    return true;\n  };\n\n  const handleChange = e => {\n    setFormValues({ ...formValues,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  if (redirectTo) {\n    return React.createElement(Redirect, {\n      to: {\n        pathname: redirectTo\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    className: \"my-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, \"Login\"), location.state && React.createElement(FlashMessage, {\n    flashMessage: location.state.flashMessage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }), React.createElement(FormErrors, {\n    formErrors: formErrors,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }), React.createElement(Form, {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(Form.Group, {\n    controlId: \"formBasicEmail\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, \"Email address\"), React.createElement(Form.Control, {\n    name: \"email\",\n    type: \"email\",\n    placeholder: \"Enter email\",\n    value: formValues.email,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), React.createElement(Form.Text, {\n    className: \"text-muted\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, \"We'll never share your email with anyone else.\")), React.createElement(Form.Group, {\n    controlId: \"formBasicPassword\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, React.createElement(Form.Label, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"Password\"), React.createElement(Form.Control, {\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    value: formValues.password,\n    onChange: handleChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  })), React.createElement(Button, {\n    variant: \"primary\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, \"Login\")));\n}\n\nexport default Login;","map":{"version":3,"sources":["/Users/apple/Desktop/submit 3/compliance-client/src/pages/Login.js"],"names":["React","useState","axios","Redirect","useLocation","FormErrors","FlashMessage","Form","Button","Login","props","formValues","setFormValues","email","password","redirectTo","setRedirectTo","formErrors","setFormErrors","location","handleSubmit","e","preventDefault","validateForm","response","post","status","console","log","setUser","isLoggedIn","data","err","errors","length","push","handleChange","target","name","value","pathname","state","flashMessage"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { Redirect, useLocation } from \"react-router-dom\";\nimport FormErrors from \"../components/FormErrors\";\nimport FlashMessage from \"../components/FlashMessage\";\nimport { Form, Button } from \"react-bootstrap\"\n\nfunction Login(props) {\n    const [formValues, setFormValues] = useState({ email: \"\", password: \"\" });\n    const [redirectTo, setRedirectTo] = useState(\"\");\n    const [formErrors, setFormErrors] = useState([]);\n    const location = useLocation();\n\n    const handleSubmit = async e => {\n        e.preventDefault();\n        if (!validateForm()) return;\n        try {\n            const response = await axios.post(\"/user/login\", formValues);\n\n            if (response.status === 200) {\n                console.log(\"logged in\");\n\n                props.setUser({\n                    isLoggedIn: true,\n                    email: response.data.email\n                });\n                setRedirectTo(\"/dashboard\");\n            } else {\n                console.log(\"not logged in\");\n                console.log(response.status);\n            }\n        } catch (err) {\n            console.log(\"login error\");\n            console.log(err.response);\n\n            if (err.response.status === 401) {\n                // Incorrect email password pair\n                setFormErrors([\"Incorrect email or password\"]);\n            } else {\n                setRedirectTo(\"/serverError\");\n            }\n        }\n    };\n\n    const validateForm = () => {\n        const errors = [];\n        if (formValues.email.length < 1) {\n            errors.push(\"Please enter your email\");\n        }\n        if (formValues.password.length < 1) {\n            errors.push(\"Please enter your password\");\n        }\n\n        if (errors.length > 0) {\n            setFormErrors(errors);\n            return false;\n        }\n        return true;\n    };\n\n    const handleChange = e => {\n        setFormValues({\n            ...formValues,\n            [e.target.name]: e.target.value\n        });\n    };\n\n    if (redirectTo) {\n        return <Redirect to={{ pathname: redirectTo }} />;\n    }\n\n   \n    return (\n        <div>\n            <h3 className=\"my-3\">Login</h3>\n            {location.state && (\n                <FlashMessage flashMessage={location.state.flashMessage} />\n            )}\n            <FormErrors formErrors={formErrors} />\n            <Form onSubmit={handleSubmit}>\n                <Form.Group controlId=\"formBasicEmail\">\n                    <Form.Label>Email address</Form.Label>\n                    <Form.Control name=\"email\" type=\"email\" placeholder=\"Enter email\" value={formValues.email}\n                        onChange={handleChange} /> \n                    <Form.Text className=\"text-muted\">\n                        We'll never share your email with anyone else.\n                    </Form.Text>\n                </Form.Group>\n\n                <Form.Group controlId=\"formBasicPassword\">\n                    <Form.Label>Password</Form.Label>\n                    <Form.Control name=\"password\" type=\"password\" placeholder=\"Password\" value={formValues.password}\n                        onChange={handleChange} />\n                </Form.Group>\n                <Button variant=\"primary\" type=\"submit\">\n                    Login\n                </Button>\n            </Form>\n        </div>\n    );\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}